import { Component, inject, Input } from '@angular/core';
import { FormsModule } from '@angular/forms';
import { MasterService } from './services/master.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
export class DashboardUiComponent {
    constructor() {
        this.masterService = inject(MasterService);
        this.BASE_URL = 'https://dev-api.file-service.mobioffice.io';
        this.menus = [];
        this.styleSketchNumber = null;
        this.selectedProcessName = null;
        this.tableData = [];
    }
    ngOnInit() {
        console.log('we are in dashboard library component');
        this.onInit();
    }
    onInit() {
        this.getAllMaster();
    }
    getAllMaster() {
        // this.masterService.getProcessList().subscribe((res: any) => {
        //   console.log(res);
        //   this.menus = res.data.map((item: any) => {
        //     return { ...item, isSelected: false };
        //   });
        // });
    }
    itemSelected(item) {
        console.log(item);
        this.selectedProcessName = item.processName;
        item.isSelected = true;
        this.menus.map((item) => {
            if (item.processName !== this.selectedProcessName)
                item.isSelected = false;
        });
        if (this.selectedProcessName) {
            const data = this.styleDetailsForDownload.filePaths[this.selectedProcessName];
            console.log(data);
            this.prepareTableData(data);
        }
    }
    prepareTableData(data) {
        this.tableData = Object.entries(data).map(([version, files]) => ({
            version,
            files: Object.entries(files).map(([fileName, details]) => ({
                fileName,
                createdDate: details.createdDate,
                url: details.url,
            })),
        }));
        console.log(this.tableData);
    }
    enterPressed() {
        const payload = {
            packetBarCode: this.styleSketchNumber,
            rootFolderName: 'uploads',
            isAllVersionNeeded: 1,
        };
        this.masterService
            .getDetailsWithProcess(payload, this.BASE_URL)
            .subscribe((res) => {
            this.styleDetailsForDownload = res;
            if (!!res?.filePaths) {
                const objectKeys = Object.keys(res?.filePaths);
                this.menus = objectKeys.map((item) => {
                    return { processName: item, isSelected: false };
                });
            }
        });
    }
    downloadFile(file) {
        const encodedUrl = encodeURIComponent(file.url);
        const fullUrl = `${this.BASE_URL}/${encodedUrl}`;
        window.open(fullUrl, '_blank');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DashboardUiComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.12", type: DashboardUiComponent, isStandalone: true, selector: "lib-file-config-library", inputs: { BASE_URL: "BASE_URL" }, providers: [MasterService], ngImport: i0, template: "<div class=\"dashboard-component p-0 m-0\">\r\n  <!-- input filed to search style / sketch number -->\r\n  <div class=\"p-10 col-3 d-flex flex-column\">\r\n    <label class=\"form-group-label text-white mb-1\">Enter Number</label>\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control input-background-color text-white\"\r\n      placeholder=\"Enter Number\"\r\n      [(ngModel)]=\"styleSketchNumber\"\r\n      (keydown.enter)=\"enterPressed()\"\r\n    />\r\n  </div>\r\n\r\n  <div class=\"row m-0 p-0 master-container\">\r\n    <div class=\"col-12 m-0 p-0 d-flex\">\r\n      <!-- Sidebar -->\r\n      <div class=\"side__bar d-flex flex-column\">\r\n        @for (item of menus; track item) {\r\n          <div\r\n            class=\"menu-item list-item border-bottom-one\"\r\n            [class.active-menu]=\"item.isSelected\"\r\n            (click)=\"itemSelected(item)\"\r\n          >\r\n            <label class=\"menu-header w-100 cursor-pointer\">\r\n              {{ item.processName }}\r\n            </label>\r\n          </div>\r\n        }\r\n      </div>\r\n\r\n      <!-- Right content -->\r\n      <div class=\"display-container flex-grow-1 ms-3 p-10\">\r\n        <h4 class=\"text-white mb-1 border-bottom-one\">File Details:</h4>\r\n\r\n        <!-- Table -->\r\n\r\n        @if (tableData.length) {\r\n          <table class=\"custom-table w-100 mt-2\">\r\n            <thead>\r\n              <tr>\r\n                <th class=\"text-white opacity-50\">Version</th>\r\n                <th class=\"text-white opacity-50\">File Name</th>\r\n                <th class=\"text-white opacity-50\">Created Date</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              @for (group of tableData; track group.version) {\r\n                @for (\r\n                  file of group.files;\r\n                  track file.fileName;\r\n                  let i = $index\r\n                ) {\r\n                  <tr>\r\n                    <td class=\"text-white opacity-50\">\r\n                      @if (i === 0) {\r\n                        {{ group.version }}\r\n                      }\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"file-cell opacity-50\">\r\n                        <span class=\"file-name text-white\">{{\r\n                          file.fileName\r\n                        }}</span>\r\n\r\n                        <svg\r\n                          class=\"download-icon\"\r\n                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                          viewBox=\"0 0 24 24\"\r\n                          width=\"16\"\r\n                          height=\"16\"\r\n                          (click)=\"downloadFile(file)\"\r\n                          title=\"Download\"\r\n                        >\r\n                          <path\r\n                            fill=\"currentColor\"\r\n                            d=\"M5 20h14v-2H5v2Zm7-18v10.17l3.59-3.58L17 10l-5 5-5-5 1.41-1.41L11 12.17V2h1Z\"\r\n                          />\r\n                        </svg>\r\n                      </div>\r\n                    </td>\r\n                    <td class=\"text-white opacity-50\">\r\n                      {{ file.createdDate }}\r\n                    </td>\r\n                  </tr>\r\n                }\r\n\r\n                <!-- <tr class=\"version-separator\">\r\n                <td colspan=\"3\"></td>\r\n              </tr> -->\r\n              }\r\n            </tbody>\r\n          </table>\r\n        }\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n", styles: [".dashboard-component{--background-color: rgb(24, 24, 27);--border-color: #d0d5dd80;--gray-dark-3: #3a3a3a;--input-background-color: rgb(40, 40, 40);--text-dark-color: #fff;--text-white-color: #000;--button-color: #ab7340;height:100vh;background-color:var(--input-background-color)}.dashboard-component .h-100{height:100px}.dashboard-component .text-dark{color:var(--text-dark-color)}.dashboard-component .text-white{color:var(--text-white-color)}.dashboard-component .h-50{height:50px}.dashboard-component .p-10{padding:10px}.dashboard-component .opacity-50{opacity:.5}.dashboard-component .input-background-color{background-color:var(--background-color)!important}.dashboard-component .input-background-color::placeholder{color:var(--text-dark-color);opacity:1}.dashboard-component .form-group-label{margin-bottom:6px!important;font-size:12px!important}.dashboard-component input.form-control{height:36px}.dashboard-component .border-bottom-one{border-bottom:1px solid var(--border-color)}.dashboard-component .cursor-pointer{cursor:pointer}.dashboard-component .master-container .side__bar .menu-header{padding:10px 14px;font-size:14px;font-weight:400}.dashboard-component .master-container .side__bar{width:200px;overflow-y:auto;max-height:calc(100vh - 60px);border-right:1px solid #d0d5dd;background-color:var(--background-color);color:var(--text-dark-color);flex-shrink:0}.dashboard-component .master-container .menu-item{position:relative}.dashboard-component .master-container .dropdown-indicator{margin-left:auto}.dashboard-component .master-container .list-item.active-menu{background-color:var(--button-color)}.dashboard-component .master-container .child-menu{display:block}.dashboard-component .master-container .child-menu div,.dashboard-component .master-container .child-menu.pl-3{padding-left:20px}.dashboard-component .master-container .sticky-search{position:sticky;top:0;z-index:10;padding:5px}.dashboard-component .master-container .menu-list{flex:1;overflow-y:auto;padding:10px 0}.dashboard-component .master-container .side__bar{display:flex;flex-direction:column;height:91vh;overflow:hidden}.dashboard-component .display-container{background-color:var(--background-color);overflow-y:auto;max-height:91vh}.dashboard-component .custom-table{border-collapse:collapse}.dashboard-component .custom-table th,.dashboard-component .custom-table td{padding:10px 12px;text-align:left;border:none}.dashboard-component .custom-table tbody tr{border-bottom:none}.dashboard-component .custom-table tbody tr{border-bottom:1px solid var(--text-dark-color)}.dashboard-component .version-separator td{height:10px;border-bottom:2px solid var(--text-dark-color)}.dashboard-component .download-icon{font-size:16px;color:var(--button-color);cursor:pointer;opacity:.8}.dashboard-component .download-icon:hover{opacity:1;transform:scale(1.1)}\n"], dependencies: [{ kind: "ngmodule", type: FormsModule }, { kind: "directive", type: i1.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DashboardUiComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lib-file-config-library', standalone: true, imports: [FormsModule], providers: [MasterService], template: "<div class=\"dashboard-component p-0 m-0\">\r\n  <!-- input filed to search style / sketch number -->\r\n  <div class=\"p-10 col-3 d-flex flex-column\">\r\n    <label class=\"form-group-label text-white mb-1\">Enter Number</label>\r\n    <input\r\n      type=\"text\"\r\n      class=\"form-control input-background-color text-white\"\r\n      placeholder=\"Enter Number\"\r\n      [(ngModel)]=\"styleSketchNumber\"\r\n      (keydown.enter)=\"enterPressed()\"\r\n    />\r\n  </div>\r\n\r\n  <div class=\"row m-0 p-0 master-container\">\r\n    <div class=\"col-12 m-0 p-0 d-flex\">\r\n      <!-- Sidebar -->\r\n      <div class=\"side__bar d-flex flex-column\">\r\n        @for (item of menus; track item) {\r\n          <div\r\n            class=\"menu-item list-item border-bottom-one\"\r\n            [class.active-menu]=\"item.isSelected\"\r\n            (click)=\"itemSelected(item)\"\r\n          >\r\n            <label class=\"menu-header w-100 cursor-pointer\">\r\n              {{ item.processName }}\r\n            </label>\r\n          </div>\r\n        }\r\n      </div>\r\n\r\n      <!-- Right content -->\r\n      <div class=\"display-container flex-grow-1 ms-3 p-10\">\r\n        <h4 class=\"text-white mb-1 border-bottom-one\">File Details:</h4>\r\n\r\n        <!-- Table -->\r\n\r\n        @if (tableData.length) {\r\n          <table class=\"custom-table w-100 mt-2\">\r\n            <thead>\r\n              <tr>\r\n                <th class=\"text-white opacity-50\">Version</th>\r\n                <th class=\"text-white opacity-50\">File Name</th>\r\n                <th class=\"text-white opacity-50\">Created Date</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              @for (group of tableData; track group.version) {\r\n                @for (\r\n                  file of group.files;\r\n                  track file.fileName;\r\n                  let i = $index\r\n                ) {\r\n                  <tr>\r\n                    <td class=\"text-white opacity-50\">\r\n                      @if (i === 0) {\r\n                        {{ group.version }}\r\n                      }\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"file-cell opacity-50\">\r\n                        <span class=\"file-name text-white\">{{\r\n                          file.fileName\r\n                        }}</span>\r\n\r\n                        <svg\r\n                          class=\"download-icon\"\r\n                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                          viewBox=\"0 0 24 24\"\r\n                          width=\"16\"\r\n                          height=\"16\"\r\n                          (click)=\"downloadFile(file)\"\r\n                          title=\"Download\"\r\n                        >\r\n                          <path\r\n                            fill=\"currentColor\"\r\n                            d=\"M5 20h14v-2H5v2Zm7-18v10.17l3.59-3.58L17 10l-5 5-5-5 1.41-1.41L11 12.17V2h1Z\"\r\n                          />\r\n                        </svg>\r\n                      </div>\r\n                    </td>\r\n                    <td class=\"text-white opacity-50\">\r\n                      {{ file.createdDate }}\r\n                    </td>\r\n                  </tr>\r\n                }\r\n\r\n                <!-- <tr class=\"version-separator\">\r\n                <td colspan=\"3\"></td>\r\n              </tr> -->\r\n              }\r\n            </tbody>\r\n          </table>\r\n        }\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n", styles: [".dashboard-component{--background-color: rgb(24, 24, 27);--border-color: #d0d5dd80;--gray-dark-3: #3a3a3a;--input-background-color: rgb(40, 40, 40);--text-dark-color: #fff;--text-white-color: #000;--button-color: #ab7340;height:100vh;background-color:var(--input-background-color)}.dashboard-component .h-100{height:100px}.dashboard-component .text-dark{color:var(--text-dark-color)}.dashboard-component .text-white{color:var(--text-white-color)}.dashboard-component .h-50{height:50px}.dashboard-component .p-10{padding:10px}.dashboard-component .opacity-50{opacity:.5}.dashboard-component .input-background-color{background-color:var(--background-color)!important}.dashboard-component .input-background-color::placeholder{color:var(--text-dark-color);opacity:1}.dashboard-component .form-group-label{margin-bottom:6px!important;font-size:12px!important}.dashboard-component input.form-control{height:36px}.dashboard-component .border-bottom-one{border-bottom:1px solid var(--border-color)}.dashboard-component .cursor-pointer{cursor:pointer}.dashboard-component .master-container .side__bar .menu-header{padding:10px 14px;font-size:14px;font-weight:400}.dashboard-component .master-container .side__bar{width:200px;overflow-y:auto;max-height:calc(100vh - 60px);border-right:1px solid #d0d5dd;background-color:var(--background-color);color:var(--text-dark-color);flex-shrink:0}.dashboard-component .master-container .menu-item{position:relative}.dashboard-component .master-container .dropdown-indicator{margin-left:auto}.dashboard-component .master-container .list-item.active-menu{background-color:var(--button-color)}.dashboard-component .master-container .child-menu{display:block}.dashboard-component .master-container .child-menu div,.dashboard-component .master-container .child-menu.pl-3{padding-left:20px}.dashboard-component .master-container .sticky-search{position:sticky;top:0;z-index:10;padding:5px}.dashboard-component .master-container .menu-list{flex:1;overflow-y:auto;padding:10px 0}.dashboard-component .master-container .side__bar{display:flex;flex-direction:column;height:91vh;overflow:hidden}.dashboard-component .display-container{background-color:var(--background-color);overflow-y:auto;max-height:91vh}.dashboard-component .custom-table{border-collapse:collapse}.dashboard-component .custom-table th,.dashboard-component .custom-table td{padding:10px 12px;text-align:left;border:none}.dashboard-component .custom-table tbody tr{border-bottom:none}.dashboard-component .custom-table tbody tr{border-bottom:1px solid var(--text-dark-color)}.dashboard-component .version-separator td{height:10px;border-bottom:2px solid var(--text-dark-color)}.dashboard-component .download-icon{font-size:16px;color:var(--button-color);cursor:pointer;opacity:.8}.dashboard-component .download-icon:hover{opacity:1;transform:scale(1.1)}\n"] }]
        }], propDecorators: { BASE_URL: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS1jb25maWctbGlicmFyeS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9maWxlLWNvbmZpZy1saWJyYXJ5L3NyYy9saWIvZmlsZS1jb25maWctbGlicmFyeS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9maWxlLWNvbmZpZy1saWJyYXJ5L3NyYy9saWIvZmlsZS1jb25maWctbGlicmFyeS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFDakUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQzs7O0FBVTFELE1BQU0sT0FBTyxvQkFBb0I7SUFSakM7UUFTVSxrQkFBYSxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztRQU9yQyxhQUFRLEdBQVcsNENBQTRDLENBQUM7UUFDekUsVUFBSyxHQUFRLEVBQUUsQ0FBQztRQUNoQixzQkFBaUIsR0FBa0IsSUFBSSxDQUFDO1FBQ3hDLHdCQUFtQixHQUFrQixJQUFJLENBQUM7UUFDMUMsY0FBUyxHQUFVLEVBQUUsQ0FBQztLQXNFdkI7SUEvRUMsUUFBUTtRQUNOLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUNyRCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQVNELE1BQU07UUFDSixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDdEIsQ0FBQztJQUVPLFlBQVk7UUFDbEIsZ0VBQWdFO1FBQ2hFLHNCQUFzQjtRQUN0QiwrQ0FBK0M7UUFDL0MsNkNBQTZDO1FBQzdDLFFBQVE7UUFDUixNQUFNO0lBQ1IsQ0FBQztJQUVELFlBQVksQ0FBQyxJQUFTO1FB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eUIsY0FDdkIsSUFBSSxXQUNQLENBQUMsV0FBVyxDQUFDLGFBQ1gsQ0FBQyxhQUFhLENBQUM7OEJBWWpCLFFBQVE7c0JBQWhCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIGluamVjdCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb3Jtc01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgTWFzdGVyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvbWFzdGVyLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdsaWItZmlsZS1jb25maWctbGlicmFyeScsXHJcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcclxuICBpbXBvcnRzOiBbRm9ybXNNb2R1bGVdLFxyXG4gIHByb3ZpZGVyczogW01hc3RlclNlcnZpY2VdLFxyXG4gIHRlbXBsYXRlVXJsOiBgLi9maWxlLWNvbmZpZy1saWJyYXJ5LmNvbXBvbmVudC5odG1sYCxcclxuICBzdHlsZVVybDogYC4vZmlsZS1jb25maWctbGlicmFyeS5jb21wb25lbnQuc2Nzc2AsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXNoYm9hcmRVaUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgcHJpdmF0ZSBtYXN0ZXJTZXJ2aWNlID0gaW5qZWN0KE1hc3RlclNlcnZpY2UpO1xyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIGNvbnNvbGUubG9nKCd3ZSBhcmUgaW4gZGFzaGJvYXJkIGxpYnJhcnkgY29tcG9uZW50Jyk7XHJcbiAgICB0aGlzLm9uSW5pdCgpO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgQkFTRV9VUkw6IHN0cmluZyA9ICdodHRwczovL2Rldi1hcGkuZmlsZS1zZXJ2aWNlLm1vYmlvZmZpY2UuaW8nO1xyXG4gIG1lbnVzOiBhbnkgPSBbXTtcclxuICBzdHlsZVNrZXRjaE51bWJlcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgc2VsZWN0ZWRQcm9jZXNzTmFtZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgdGFibGVEYXRhOiBhbnlbXSA9IFtdO1xyXG4gIHN0eWxlRGV0YWlsc0ZvckRvd25sb2FkOiBhbnk7XHJcblxyXG4gIG9uSW5pdCgpIHtcclxuICAgIHRoaXMuZ2V0QWxsTWFzdGVyKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEFsbE1hc3RlcigpIHtcclxuICAgIC8vIHRoaXMubWFzdGVyU2VydmljZS5nZXRQcm9jZXNzTGlzdCgpLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgIC8vICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgIC8vICAgdGhpcy5tZW51cyA9IHJlcy5kYXRhLm1hcCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAvLyAgICAgcmV0dXJuIHsgLi4uaXRlbSwgaXNTZWxlY3RlZDogZmFsc2UgfTtcclxuICAgIC8vICAgfSk7XHJcbiAgICAvLyB9KTtcclxuICB9XHJcblxyXG4gIGl0ZW1TZWxlY3RlZChpdGVtOiBhbnkpIHtcclxuICAgIGNvbnNvbGUubG9nKGl0ZW0pO1xyXG4gICAgdGhpcy5zZWxlY3RlZFByb2Nlc3NOYW1lID0gaXRlbS5wcm9jZXNzTmFtZTtcclxuICAgIGl0ZW0uaXNTZWxlY3RlZCA9IHRydWU7XHJcbiAgICB0aGlzLm1lbnVzLm1hcCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgIGlmIChpdGVtLnByb2Nlc3NOYW1lICE9PSB0aGlzLnNlbGVjdGVkUHJvY2Vzc05hbWUpXHJcbiAgICAgICAgaXRlbS5pc1NlbGVjdGVkID0gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAodGhpcy5zZWxlY3RlZFByb2Nlc3NOYW1lKSB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPVxyXG4gICAgICAgIHRoaXMuc3R5bGVEZXRhaWxzRm9yRG93bmxvYWQuZmlsZVBhdGhzW3RoaXMuc2VsZWN0ZWRQcm9jZXNzTmFtZV07XHJcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICB0aGlzLnByZXBhcmVUYWJsZURhdGEoZGF0YSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcmVwYXJlVGFibGVEYXRhKGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy50YWJsZURhdGEgPSBPYmplY3QuZW50cmllcyhkYXRhKS5tYXAoKFt2ZXJzaW9uLCBmaWxlc106IGFueSkgPT4gKHtcclxuICAgICAgdmVyc2lvbixcclxuICAgICAgZmlsZXM6IE9iamVjdC5lbnRyaWVzKGZpbGVzKS5tYXAoKFtmaWxlTmFtZSwgZGV0YWlsc106IGFueSkgPT4gKHtcclxuICAgICAgICBmaWxlTmFtZSxcclxuICAgICAgICBjcmVhdGVkRGF0ZTogZGV0YWlscy5jcmVhdGVkRGF0ZSxcclxuICAgICAgICB1cmw6IGRldGFpbHMudXJsLFxyXG4gICAgICB9KSksXHJcbiAgICB9KSk7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLnRhYmxlRGF0YSk7XHJcbiAgfVxyXG5cclxuICBlbnRlclByZXNzZWQoKSB7XHJcbiAgICBjb25zdCBwYXlsb2FkID0ge1xyXG4gICAgICBwYWNrZXRCYXJDb2RlOiB0aGlzLnN0eWxlU2tldGNoTnVtYmVyLFxyXG4gICAgICByb290Rm9sZGVyTmFtZTogJ3VwbG9hZHMnLFxyXG4gICAgICBpc0FsbFZlcnNpb25OZWVkZWQ6IDEsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMubWFzdGVyU2VydmljZVxyXG4gICAgICAuZ2V0RGV0YWlsc1dpdGhQcm9jZXNzKHBheWxvYWQsIHRoaXMuQkFTRV9VUkwpXHJcbiAgICAgIC5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgdGhpcy5zdHlsZURldGFpbHNGb3JEb3dubG9hZCA9IHJlcztcclxuICAgICAgICBpZiAoISFyZXM/LmZpbGVQYXRocykge1xyXG4gICAgICAgICAgY29uc3Qgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzKHJlcz8uZmlsZVBhdGhzKTtcclxuICAgICAgICAgIHRoaXMubWVudXMgPSBvYmplY3RLZXlzLm1hcCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHByb2Nlc3NOYW1lOiBpdGVtLCBpc1NlbGVjdGVkOiBmYWxzZSB9O1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGRvd25sb2FkRmlsZShmaWxlOiBhbnkpIHtcclxuICAgIGNvbnN0IGVuY29kZWRVcmwgPSBlbmNvZGVVUklDb21wb25lbnQoZmlsZS51cmwpO1xyXG4gICAgY29uc3QgZnVsbFVybCA9IGAke3RoaXMuQkFTRV9VUkx9LyR7ZW5jb2RlZFVybH1gO1xyXG4gICAgd2luZG93Lm9wZW4oZnVsbFVybCwgJ19ibGFuaycpO1xyXG4gIH1cclxufVxyXG4iLCI8ZGl2IGNsYXNzPVwiZGFzaGJvYXJkLWNvbXBvbmVudCBwLTAgbS0wXCI+XHJcbiAgPCEtLSBpbnB1dCBmaWxlZCB0byBzZWFyY2ggc3R5bGUgLyBza2V0Y2ggbnVtYmVyIC0tPlxyXG4gIDxkaXYgY2xhc3M9XCJwLTEwIGNvbC0zIGQtZmxleCBmbGV4LWNvbHVtblwiPlxyXG4gICAgPGxhYmVsIGNsYXNzPVwiZm9ybS1ncm91cC1sYWJlbCB0ZXh0LXdoaXRlIG1iLTFcIj5FbnRlciBOdW1iZXI8L2xhYmVsPlxyXG4gICAgPGlucHV0XHJcbiAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgaW5wdXQtYmFja2dyb3VuZC1jb2xvciB0ZXh0LXdoaXRlXCJcclxuICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciBOdW1iZXJcIlxyXG4gICAgICBbKG5nTW9kZWwpXT1cInN0eWxlU2tldGNoTnVtYmVyXCJcclxuICAgICAgKGtleWRvd24uZW50ZXIpPVwiZW50ZXJQcmVzc2VkKClcIlxyXG4gICAgLz5cclxuICA8L2Rpdj5cclxuXHJcbiAgPGRpdiBjbGFzcz1cInJvdyBtLTAgcC0wIG1hc3Rlci1jb250YWluZXJcIj5cclxuICAgIDxkaXYgY2xhc3M9XCJjb2wtMTIgbS0wIHAtMCBkLWZsZXhcIj5cclxuICAgICAgPCEtLSBTaWRlYmFyIC0tPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwic2lkZV9fYmFyIGQtZmxleCBmbGV4LWNvbHVtblwiPlxyXG4gICAgICAgIEBmb3IgKGl0ZW0gb2YgbWVudXM7IHRyYWNrIGl0ZW0pIHtcclxuICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgY2xhc3M9XCJtZW51LWl0ZW0gbGlzdC1pdGVtIGJvcmRlci1ib3R0b20tb25lXCJcclxuICAgICAgICAgICAgW2NsYXNzLmFjdGl2ZS1tZW51XT1cIml0ZW0uaXNTZWxlY3RlZFwiXHJcbiAgICAgICAgICAgIChjbGljayk9XCJpdGVtU2VsZWN0ZWQoaXRlbSlcIlxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJtZW51LWhlYWRlciB3LTEwMCBjdXJzb3ItcG9pbnRlclwiPlxyXG4gICAgICAgICAgICAgIHt7IGl0ZW0ucHJvY2Vzc05hbWUgfX1cclxuICAgICAgICAgICAgPC9sYWJlbD5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIH1cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICA8IS0tIFJpZ2h0IGNvbnRlbnQgLS0+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJkaXNwbGF5LWNvbnRhaW5lciBmbGV4LWdyb3ctMSBtcy0zIHAtMTBcIj5cclxuICAgICAgICA8aDQgY2xhc3M9XCJ0ZXh0LXdoaXRlIG1iLTEgYm9yZGVyLWJvdHRvbS1vbmVcIj5GaWxlIERldGFpbHM6PC9oND5cclxuXHJcbiAgICAgICAgPCEtLSBUYWJsZSAtLT5cclxuXHJcbiAgICAgICAgQGlmICh0YWJsZURhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICA8dGFibGUgY2xhc3M9XCJjdXN0b20tdGFibGUgdy0xMDAgbXQtMlwiPlxyXG4gICAgICAgICAgICA8dGhlYWQ+XHJcbiAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwidGV4dC13aGl0ZSBvcGFjaXR5LTUwXCI+VmVyc2lvbjwvdGg+XHJcbiAgICAgICAgICAgICAgICA8dGggY2xhc3M9XCJ0ZXh0LXdoaXRlIG9wYWNpdHktNTBcIj5GaWxlIE5hbWU8L3RoPlxyXG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwidGV4dC13aGl0ZSBvcGFjaXR5LTUwXCI+Q3JlYXRlZCBEYXRlPC90aD5cclxuICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICA8L3RoZWFkPlxyXG5cclxuICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgIEBmb3IgKGdyb3VwIG9mIHRhYmxlRGF0YTsgdHJhY2sgZ3JvdXAudmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgQGZvciAoXHJcbiAgICAgICAgICAgICAgICAgIGZpbGUgb2YgZ3JvdXAuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICAgIHRyYWNrIGZpbGUuZmlsZU5hbWU7XHJcbiAgICAgICAgICAgICAgICAgIGxldCBpID0gJGluZGV4XHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInRleHQtd2hpdGUgb3BhY2l0eS01MFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgQGlmIChpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt7IGdyb3VwLnZlcnNpb24gfX1cclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmaWxlLWNlbGwgb3BhY2l0eS01MFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZpbGUtbmFtZSB0ZXh0LXdoaXRlXCI+e3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmZpbGVOYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19PC9zcGFuPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN2Z1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZG93bmxvYWQtaWNvblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld0JveD1cIjAgMCAyNCAyNFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9XCIxNlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PVwiMTZcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIChjbGljayk9XCJkb3dubG9hZEZpbGUoZmlsZSlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiRG93bmxvYWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGw9XCJjdXJyZW50Q29sb3JcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZD1cIk01IDIwaDE0di0ySDV2MlptNy0xOHYxMC4xN2wzLjU5LTMuNThMMTcgMTBsLTUgNS01LTUgMS40MS0xLjQxTDExIDEyLjE3VjJoMVpcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJ0ZXh0LXdoaXRlIG9wYWNpdHktNTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIHt7IGZpbGUuY3JlYXRlZERhdGUgfX1cclxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIDwhLS0gPHRyIGNsYXNzPVwidmVyc2lvbi1zZXBhcmF0b3JcIj5cclxuICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPVwiM1wiPjwvdGQ+XHJcbiAgICAgICAgICAgICAgPC90cj4gLS0+XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICB9XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PlxyXG4iXX0=